# Production Environment Configuration
# Copy to .env.production and fill in real values
# Run with: docker compose -f docker-compose.prod.yml --env-file .env.production up -d

# =============================================================================
# Server Configuration
# =============================================================================
PORT=3000
NODE_ENV=production

# Frontend URL (for CORS - must match your production domain)
FRONTEND_URL=https://photos.joeczar.com

# =============================================================================
# Database
# =============================================================================
# Connection string (container name 'postgres' resolves within Docker network)
# IMPORTANT: RLS INSERT policies expect database user 'vacay' (see schema.sql)
#
# CRITICAL: Use the ACTUAL password here, NOT ${POSTGRES_PASSWORD} or any placeholder
#           Docker env_file does NOT support variable substitution in this context
#           The password MUST match POSTGRES_PASSWORD in root .env.production
#
# Example:
#   If .env.production has: POSTGRES_PASSWORD=mySecretPass123
#   Then use here: DATABASE_URL=postgresql://vacay:mySecretPass123@postgres:5432/vacay
DATABASE_URL=postgresql://vacay:REPLACE_WITH_STRONG_PASSWORD@postgres:5432/vacay
DATABASE_SSL=false
DATABASE_POOL_SIZE=10
DATABASE_IDLE_TIMEOUT_MS=10000

# =============================================================================
# JWT Configuration
# =============================================================================
# Generate with: openssl rand -hex 32
# CRITICAL: Use a strong, unique secret in production
JWT_SECRET=REPLACE_ME_generate_with_openssl_rand_hex_32
JWT_EXPIRATION=1h

# =============================================================================
# WebAuthn Configuration (Passkeys)
# =============================================================================
# RP_ID: Your production domain (no protocol, no port)
RP_ID=photos.joeczar.com
RP_NAME=Vacay Photo Map
# RP_ORIGIN: Full origin URL (must match exactly what browser sends)
RP_ORIGIN=https://photos.joeczar.com

# =============================================================================
# Storage: Cloudflare R2 (Recommended for Production)
# =============================================================================
# Get credentials from Cloudflare dashboard: R2 > Manage R2 API Tokens
R2_ACCOUNT_ID=your_account_id
R2_ACCESS_KEY_ID=your_access_key
R2_SECRET_ACCESS_KEY=your_secret_key
R2_BUCKET_NAME=vacay-photos

# Local fallback (used if R2 not configured)
PHOTOS_DIR=/data/photos

# =============================================================================
# Proxy Configuration
# =============================================================================
# REQUIRED for production behind Caddy/Cloudflare
# Enables proper IP forwarding for rate limiting
TRUSTED_PROXY=true

# =============================================================================
# GitHub Container Registry (for Watchtower)
# =============================================================================
# If your ghcr.io image is private, Watchtower needs credentials.
# Create a GitHub PAT with 'read:packages' scope.
# Then on your server, run:
#   echo YOUR_PAT | docker login ghcr.io -u YOUR_GITHUB_USERNAME --password-stdin
#
# Alternatively, configure Watchtower with these env vars in docker-compose:
#   REPO_USER: your_github_username
#   REPO_PASS: your_github_pat
