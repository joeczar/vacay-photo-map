services:
  postgres:
    # Inherit base config; override if you need a different port mapping locally
    ports:
      - '5432:5432'

  api:
    image: oven/bun:1.3
    container_name: vacay-api
    working_dir: /app
    depends_on:
      postgres:
        condition: service_healthy
    environment:
      PORT: 3000
      NODE_ENV: development
      FRONTEND_URL: http://localhost:5173
      DATABASE_URL: postgresql://vacay:vacay@postgres:5432/vacay
    volumes:
      - ./api:/app
      # Keep container node_modules isolated to avoid host conflicts/permissions
      - /app/node_modules
    command: >
      sh -c "bun install && bun run --hot src/index.ts"
    ports:
      - '3000:3000'
